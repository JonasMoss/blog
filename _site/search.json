[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Jonas Moss' blog",
    "section": "",
    "text": "statistics\n\n\neducation\n\n\n\n\n\n\n\n\n\n\n\nJan 25, 2023\n\n\nJonas Moss\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nstatistics\n\n\njoking\n\n\n\n\n\n\n\n\n\n\n\nJan 25, 2023\n\n\nJonas Moss\n\n\n\n\n\n\n\n\n\n\n\n\n\n\neffective altruism\n\n\nstatistics\n\n\nfermi estimates\n\n\n\n\n\n\n\n\n\n\n\nOct 20, 2022\n\n\nJonas Moss\n\n\n\n\n\n\n\n\n\n\n\n\n\n\neffective altruism\n\n\nstatistics\n\n\npsychometrics\n\n\neconomics\n\n\nmarketing\n\n\n\n\n\n\n\n\n\n\n\nOct 7, 2022\n\n\nJonas Moss\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nstatistics\n\n\npsychometrics\n\n\n\n\n\n\n\n\n\n\n\nOct 6, 2022\n\n\nJonas Moss\n\n\n\n\n\n\n\n\n\n\n\n\n\n\neffective altruism\n\n\nstatistics\n\n\npsychometrics\n\n\n\n\n\n\n\n\n\n\n\nOct 5, 2022\n\n\nJonas Moss\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nteaching\n\n\nacademia\n\n\n\n\n\n\n\n\n\n\n\nOct 4, 2022\n\n\nJonas Moss\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nstatistics\n\n\npsychometrics\n\n\n\n\n\n\n\n\n\n\n\nOct 3, 2022\n\n\nJonas Moss\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "posts/two-lines/index.html",
    "href": "posts/two-lines/index.html",
    "title": "Correlation with two lines!",
    "section": "",
    "text": "What is this? A rant about an unimportant problem. Read at your own risk!\nEveryone knows the correlation coefficient. It measures the degree of linear dependence between two random variables \\(X\\) and \\(Y\\). It finds the best-fitting line \\(Y=a+bX\\) and measures how far the observed values of \\(Y\\) are from the predicted values of \\(y\\) given \\(X\\).\nThat should be familiar. But what if there are TWO parallel lines in the data?!\nThe data has been simulated from the model \\[\\begin{eqnarray*}\ny\\mid x,z=0 & \\sim & 2x+1+\\frac{1}{2}\\epsilon,\\\\\ny\\mid x,z=1 & \\sim & 2x+2+\\frac{1}{2}\\epsilon.\n\\end{eqnarray*}\\] where \\(z\\) is a group indicator and \\(\\epsilon\\) is standard normal. Moreover, the \\(x\\)s are \\(50\\) observations uniformly spaced on \\([0,1]\\). What is the marginal model, with \\(z\\) integrated out? It’s \\(2x + 3/2\\), displayed on the right. The plot on the right certainly doesn’t look like it contains two lines.\nIf we know the joint distribution of \\((X,Y,Z)\\) , generalizing the correlation is easy! The ordinary correlation coefficient can be written as \\(\\operatorname{Cor}(X,Y)=\\operatorname{sign}\\beta\\sqrt{R^{2}}\\),where \\[R^{2}=1-\\frac{\\min_{a,b}E\\left[(Y-a-bX)^{2}\\right]}{\\min_{\\mu}E\\left[(Y-\\mu)^{2}\\right]},\\] and \\(\\beta\\) is the minimizing slope of the numerator. Now just add the covariate \\(1[Z=1]\\) to the linear regression model in the denominator, and the resulting correlation becomes \\[\\operatorname{Cor}(X,Y;Z)=\\operatorname{sign}\\beta\\sqrt{R_\\star^{2}},\\] where \\[R^{2}_\\star=1-\\frac{\\min_{a,b}E\\left[(Y-a_{0}-a_{1}1[Z=1]-bX)^{2}\\right]}{\\min_{\\mu}E\\left[(Y-\\mu)^{2}\\right]},\\] and \\(\\beta\\) is the minimizing slope of the numerator (the sign of the slope is unambiguous since we’ve assumed the lines are parallel).\nCalculating this correlation coefficient is easy as pie.\nAnd its much larger than the “one-line correlation”, going from \\(0.62\\) to \\(0.85\\). But we can’t calculate it without knowing \\(Z\\)!"
  },
  {
    "objectID": "posts/two-lines/index.html#defining-a-correlation-for-two-parallel-lines",
    "href": "posts/two-lines/index.html#defining-a-correlation-for-two-parallel-lines",
    "title": "Correlation with two lines!",
    "section": "Defining a correlation for two parallel lines",
    "text": "Defining a correlation for two parallel lines\nSo, we know the joint distribution of \\((x,y)\\), and nothing more. How can think about the “two-lines correlation”? I can only think of one reasonable way to solve the problem. We need to find lower and upper bounds for \\(\\operatorname{Cor}(X,Y;Z)\\). Because we might not know \\(Z\\), but maybe we can find bounds for the correlation \\(\\operatorname{Cor}(X,Y;Z)\\) that we could have calculate had we known \\(Z\\).\n\nFinding bounds\nI can’t think of an efficient way to calculate upper bounds, but the lower bound is simple enough (in the case when the correlation is positive): It equals \\(\\operatorname{Cor}(X,Y)\\). When dealing with estimation problems, a reasonable estimator of the upper bound would be to make every possible split of the data into into two categories (according to z)and fit the regression model y ~ x + z. But that would be \\(2^n\\) combinations, which is obviously intractable for large \\(n\\). It might be possible to find exact algorithms that aren’t exponential in time, indeed, I would expect it, but I can’t justify spending more time on this problem.\nHowever, consider the following data\n\nn <- 15\nx <- mtcars$drat[1:n]\ny <- mtcars$wt[1:n]\n\nSince \\(2^{15}= 32768\\) we don’t need to fit that many linear regressions to estimate the upper correlation bound in this case.\n\n\nCode estimating a bunch of regression models.\nn <- 15\nx <- mtcars$drat[1:n]\ny <- mtcars$wt[1:n]\nn <- length(x)\n\nmat <- cbind(1, x, 0)\nminimum = Inf\n\nfor(k in seq(0:n)) {\n  icomb <- arrangements::icombinations(n, k)\n  choose(n, k)\n  for(i in seq(choose(n, k))) {\n    indices <- icomb$getnext()\n    mat[, 3] <- 0\n    mat[indices, 3] <- 1\n    mod <- lm.fit(mat, y)\n    current <- sum(mod$residuals^2)\n    if (current < minimum) {\n      minimum = current\n      z = indices\n      coef <- mod$coefficients\n    }\n  }  \n}\n\ncor2 <- sqrt(1 - minimum/sum((y - mean(y))^2)) * sign(coef[2])\ncor1 <- cor(x, y)\n\n\nFrom the code above we find that lower and upper bounds for the two lines correlation:\n\nc(lower = cor2, upper = cor1)\n\n   lower.x      upper \n-0.8834406 -0.6358763 \n\n\nLet’s also have a look at the classification of points that maximizes this correlation.\n\n\nCode for plot.\ncol <- rep(\"blue\", n)\ncol[z] <- \"red\"\nplot(x, y, col = col, xlab = \"Rear axle ratio\", ylab = \"Weight\",\n     pch = 20, main = \"Two lines or one line?\")\nabline(a = coef[1], b = coef[2], col = \"blue\")\nabline(a = coef[1] + coef[3], b = coef[2], col = \"red\")\nabline(lm(y ~ x))\n\n\n\n\n\nPlot of correlation with two lines.\n\n\n\n\nThe two lines correlation for this optimal classification equals the lower bound above."
  }
]